REPORT Z01_CALCULADORA_01.

* Criação dos tipos de dados
TYPES: BEGIN OF TY_TABUADA,
         NUMERO01  TYPE INT4,
         OPERADOR,
         NUMERO02  TYPE INT4,
         RESULTADO TYPE INT4,
       END OF TY_TABUADA.

* Criação da tabela grobal
DATA: GT_RES_TABUADA      TYPE STANDARD TABLE OF TY_TABUADA.
*DATA: GT_RESULTADO_GERAL  TYPE INT4.

DATA: GV_RESULTADO    TYPE INT4,
      GV_MENSAGEM(50) TYPE C.

DATA: GV_OPERADOR TYPE C.
DATA: P_CONT      TYPE INT4.

SELECTION-SCREEN BEGIN OF BLOCK BL1 WITH FRAME TITLE TEXT-001.
PARAMETERS: OP_SOMA RADIOBUTTON GROUP GRP1,
            OP_SUBT RADIOBUTTON GROUP GRP1,
            OP_MULT RADIOBUTTON GROUP GRP1,
            OP_DIVI RADIOBUTTON GROUP GRP1.
SELECTION-SCREEN END OF BLOCK BL1.

SELECTION-SCREEN BEGIN OF BLOCK BL2 WITH FRAME TITLE TEXT-002.
PARAMETERS: P_NUM01 TYPE INT4,
            P_NUM02 TYPE INT4.
SELECTION-SCREEN END OF BLOCK BL2.

SELECTION-SCREEN BEGIN OF BLOCK BL3 WITH FRAME TITLE TEXT-003.
PARAMETERS: PTABUADA AS CHECKBOX,
            P_VALOR  TYPE INT4.
SELECTION-SCREEN END OF BLOCK BL3.

START-OF-SELECTION.
  IF OP_SOMA = 'X'.
    GV_OPERADOR = '+'.
  ELSEIF OP_SUBT IS NOT INITIAL.
    GV_OPERADOR = '-'.
    CLEAR P_CONT.
  ELSEIF OP_MULT IS NOT INITIAL.
    GV_OPERADOR = '*'.
  ELSEIF OP_DIVI NE SPACE.
    GV_OPERADOR = '/'.
  ENDIF.

  IF PTABUADA IS INITIAL.
    CASE GV_OPERADOR.
      WHEN '+'.
        GV_RESULTADO = P_NUM01 + P_NUM02.
        WRITE: /2 'A soma de', P_NUM01 , '+', P_NUM02, 'é =', GV_RESULTADO.
      WHEN '-'.
        IF P_NUM01 < P_NUM02.
          MESSAGE S005(Z01) WITH 'O primeiro valor deverá ser >= o segundo valor' DISPLAY LIKE 'E'.
          EXIT.
        ENDIF.

        GV_RESULTADO = P_NUM01 - P_NUM02.
        WRITE: /2 'A subtração de ', P_NUM01, '-', P_NUM02, 'é =', GV_RESULTADO.
      WHEN '*'.
        GV_RESULTADO = P_NUM01 * P_NUM02.
        WRITE: /2 'A multplicação de ', P_NUM01, '*', P_NUM02, 'é =', GV_RESULTADO.
      WHEN '/'.
        IF P_NUM02 = 0.
          MESSAGE S005(Z01) WITH 'Não existe divisão por zero' DISPLAY LIKE 'E'.
          EXIT.
        ELSEIF P_NUM01 < P_NUM02.
          MESSAGE S005(Z01) WITH 'O segundo valor deverá ser <= o primeiro valor' DISPLAY LIKE 'E'.
          EXIT.
        ENDIF.
        GV_RESULTADO = P_NUM01 / P_NUM02.
        WRITE: /2 'A divião de ', P_NUM01, '/', P_NUM02, 'é = ', GV_RESULTADO.
    ENDCASE.

  ELSE.
    P_NUM02 = P_VALOR.
    DO 10 TIMES.
      P_NUM01 = SY-INDEX.
      CASE GV_OPERADOR.
        WHEN '+'.
          GV_RESULTADO = P_NUM01 + P_NUM02.
          WRITE:/5 P_NUM01 , 20 GV_OPERADOR, 35 P_NUM02, 50 ' = ', 65 GV_RESULTADO.
        WHEN '-'.
          P_NUM01 = SY-INDEX + P_VALOR.
          WRITE:/5 P_NUM01 , 20 GV_OPERADOR, 35 P_NUM02, 50 ' = ', 65 GV_RESULTADO.
        WHEN '*'.
          GV_RESULTADO = P_NUM01 * P_NUM02.
          WRITE: /5 P_NUM01 , 20 GV_OPERADOR, 35 P_NUM02, 50 ' = ', 65 GV_RESULTADO.
        WHEN '/'.
          P_NUM01 = P_NUM02.
          GV_RESULTADO = P_NUM01 / P_VALOR.
          WRITE: /5 P_NUM01 , 20 GV_OPERADOR, 35 P_VALOR, 50 ' = ', 65 GV_RESULTADO.
          P_NUM02 = P_NUM01 + P_VALOR.
      ENDCASE.
    ENDDO.
  ENDIF.
